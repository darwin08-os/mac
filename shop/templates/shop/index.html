{% extends "shop/basic.html" %}
   {%block style%} <style>

      .col-md-3{
        display: inline-block;
        margin-left: -4px;
      }

      .col-md-3 img{
        width: 100%;
        height: auto;
      }

      /* by this indicating 3 lines are below the container */
      body .carousel-indicators{
        margin-bottom: -20px;
      }
      body .carousel-indicators li{
        
        background-color:blue ;
      }

      body .carousel-control-prev-icon,
      body .carousel-control-next-icon{
        background-color: blue;
      }

      body .no-padding{
        padding-left: 0;
        padding-right: 0;
      }

      body .carousel-indicators{
        bottom: 0;
        z-index: -1;
      }

      .carousel-control-prev,
      .carousel-control-next{
        margin-top: -250px;
        top:auto;
        bottom: auto;
      }

      .carousel-indicators .active{
        background-color: blue;
      }

      

      .custom-image{
        width: 286px !important;
        height: 180px !important;
      }
      
      header{
        position: sticky;
        top: 0;
        z-index: 10;
        justify-content: space-between;
        padding-right: 50px;
      }


    </style>
    {% endblock %}
    {%load static %} 
    <link rel="stylesheet" href="{%static 'shop/css/index.css'%}">
 
   
    {%block container%}
    <div class="container">

      <!-- slide show starts here. -->
      {% for products,range,nslides in allprods %}

      <h1 class="my-4" >{{products.0.category}}</h1>
       
      <div id="demo{{forloop.counter}}" class="carousel slide my-3" data-ride = "carousel">
        <ul class="carousel-indicators">
          <li data-target = "#demo{{forloop.counter}}" data-slide-to = "0" class="active"></li>
          {% for i in range %}
          <li data-target = "#demo{{forloop.parentloop.counter}}" data-slide-to ="{{i}}"></li>
          {%endfor%}
        </ul>

    
    <div class="container carousel-inner no-padding">
    <div class="carousel-item active">
      {% for i in products %}
      <div class="col-xs-3 col-sm-3 col-md-3">
        <div class="card" style="width: 18rem;">
          <img class="card-img-top custom-image" src="/media/{{i.image}}" alt="Card image cap">
          <div class="card-body">
            <h5 class="card-title">{{i.product_name}}</h5>
            <span><strong> &#8377;{{i.price}} </strong></span>


            <p class="card-text">{{i.desc}}</p> 
            <span class="cartbtn">
              <button id="pr{{i.id}}" class="btn btn-primary cart">Add to cart</button>
            </span>
              <a id="qv{{i.id}}" href="/shop/products/{{i.id}}" class="btn btn-primary">Quick view</a>

          </div>
        </div>
      </div>    

      {% if forloop.counter|divisibleby:4 and forloop.counter > 0 and not forloop.last %}
      </div><div class="carousel-item">
      {% endif %}
      {%endfor%}
    </div>
  </div>
  
</div> 

<!-- left and right controls for the slide -->
<a href="#demo{{forloop.counter}}" class="carousel-control-prev" data-slide="prev">
  <span class="carousel-control-prev-icon"></span>
</a>  

<a href="#demo{{forloop.counter}}" class="carousel-control-next" data-slide="next">
  <span class="carousel-control-next-icon"></span>
</a> 

  {%endfor%}
</div>
{%endblock%}
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>



    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


    {% block js %}
    <script>
    // this needs to be pasted in basic.html 
      if(localStorage.getItem('cart') == null){
        let cart = {};
      }
      else{
        cart = JSON.parse(localStorage.getItem('cart'))
        document.getElementById("cart").innerHTML = Object.keys(cart).length
      }

      $('.cart').click(function(){
        var idstr = this.id.toString();
        if(cart[idstr] != undefined){
          cart[idstr] += 1
        }
        else{
          cart[idstr] = 1
        }
        
        //to get values cart.idstr
       
      });
        localStorage.setItem('cart', JSON.stringify(cart))
        document.getElementById("cart").innerHTML = Object.keys(cart).length
       
      


      $('#cartpop').popover()

      $('#cartclear').click(function(){
          localStorage.clear();
          let cart = {};  
          $('#cart').html(Object.keys(cart).length);
      });

      

  document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".card-text").forEach(chars => {
    if (chars.textContent.length > 32) {
      chars.textContent = chars.textContent.slice(0, 31) + "...";
    }
  });
});

    </script>
    {% endblock %}
  